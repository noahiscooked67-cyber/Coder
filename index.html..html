<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2113.65">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
    span.s1 {font: 12.0px 'Apple Color Emoji'}
    span.s2 {font: 12.0px 'Zapf Dingbats'}
    span.s3 {font: 12.0px 'Lucida Grande'}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;title&gt;hack.io // UltraWide&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&amp;family=Orbitron:wght@700&amp;family=JetBrains+Mono&amp;display=swap" rel="stylesheet"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>:root {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>--bg-main: #0D0D0D;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>--bg-sidebar: #000000;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>--text-primary: #FFFFFF;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>--text-dim: #B4B4B4;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>--input-bg: #161616;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>--border: #262626;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>body, html { margin: 0; padding: 0; height: 100%; background: var(--bg-main); color: var(--text-primary); font-family: 'Inter', sans-serif; overflow: hidden; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.app-wrapper {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>display: grid;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>grid-template-columns: 280px 1fr;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>height: 100vh;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>width: 100vw;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/* --- SIDEBAR --- */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>#sidebar { background: var(--bg-sidebar); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 15px; overflow: hidden; z-index: 10; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.logo { font-family: 'Orbitron'; font-size: 20px; padding: 20px; letter-spacing: 3px; text-align: center; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.new-chat-btn { background: #fff; color: #000; border: none; padding: 14px; border-radius: 8px; font-weight: bold; cursor: pointer; margin-bottom: 20px; font-family: 'Orbitron'; font-size: 11px; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>#history-list { flex: 1; overflow-y: auto; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.history-item { padding: 12px; border-radius: 8px; cursor: pointer; font-size: 13px; display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px; border: 1px solid transparent; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.history-item:hover { background: #111; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.history-item.active { background: #161616; border-color: var(--border); }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.item-actions { display: flex; gap: 8px; opacity: 0; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.history-item:hover .item-actions { opacity: 1; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.action-btn { cursor: pointer; color: var(--text-dim); }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/* --- MAIN VIEW --- */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>#main-container { display: flex; flex-direction: column; background: var(--bg-main); overflow: hidden; width: 100%; position: relative; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>#chat-window { flex: 1; overflow-y: auto; width: 100%; scroll-behavior: smooth; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>#empty-state { flex: 1; display: flex; align-items: center; justify-content: center; opacity: 0.3; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.message-row { width: 100%; display: flex; padding: 30px 0; border-bottom: 1px solid #141414; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.message-content { width: 100%; padding: 0 40px; display: flex; gap: 25px; box-sizing: border-box; flex-direction: column; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.msg-header { display: flex; gap: 25px; align-items: flex-start; }</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.txt { flex: 1; line-height: 1.8; font-size: 16px; word-wrap: break-word; min-width: 0; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.avatar { width: 40px; height: 40px; border-radius: 6px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-family: 'Orbitron'; font-size: 12px; border: 1px solid #333; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.ai-avatar { background: #fff; color: #000; border-color: #fff; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/* --- FILE UI --- */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.file-attachment { background: #1A1A1A; border: 1px solid var(--border); border-radius: 10px; padding: 12px 20px; display: flex; align-items: center; gap: 15px; margin-top: 10px; max-width: 400px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.staged-file { background: #222; border: 1px solid #444; padding: 8px 15px; border-radius: 8px; display: none; align-items: center; gap: 10px; margin-bottom: 10px; width: fit-content; font-size: 13px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.remove-file { cursor: pointer; color: #ff4b4b; font-weight: bold; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/* --- INPUT --- */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>#input-container { padding: 25px 40px; background: #000; width: 100%; box-sizing: border-box; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.search-bar { width: 100%; background: var(--input-bg); border: 1px solid var(--border); border-radius: 12px; display: flex; align-items: center; padding: 15px 25px; gap: 20px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>input[type="text"] { flex: 1; background: transparent; border: none; color: #fff; font-size: 18px; outline: none; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.send-btn { background: #fff !important; color: #000 !important; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; font-weight: bold; cursor: pointer; border: none; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/* --- DROP OVERLAY --- */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>#drop-zone { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(255, 255, 255, 0.05); border: 4px dashed #fff; display: none; align-items: center; justify-content: center; z-index: 9999; pointer-events: none; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>body.dragging #drop-zone { display: flex; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)" ondrop="handleDrop(event)"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div id="drop-zone"&gt;&lt;h2 style="font-family:'Orbitron'; background:#000; padding:20px; border-radius:10px;"&gt;DROP FILE&lt;/h2&gt;&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="app-wrapper"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div id="sidebar"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="logo"&gt;HACK.IO&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;button class="new-chat-btn" onclick="createNewSession()"&gt;+ NEW SESSION&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="history-list"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div id="main-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="empty-state"&gt;&lt;h1 style="font-family:'Orbitron'; font-size:40px; letter-spacing:15px;"&gt;HACK.IO&lt;/h1&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="chat-window" style="display:none;"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="input-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="file-preview-area" class="staged-file"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span&gt;<span class="s1">ðŸ“„</span>&lt;/span&gt; &lt;span id="staged-filename"&gt;&lt;/span&gt;<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="remove-file" onclick="clearStagedFile()"&gt;<span class="s2">âœ•</span>&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="search-bar"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;input type="text" id="user-input" placeholder="Message or drop file..." onkeypress="if(event.key==='Enter') handleSend()"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="send-btn" onclick="handleSend()"&gt;<span class="s3">â†‘</span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const API_KEY = "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";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let sessions = JSON.parse(localStorage.getItem('hackio_clean_v1') || '{}');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let activeId = null;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let stagedFile = null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function save() { localStorage.setItem('hackio_clean_v1', JSON.stringify(sessions)); refreshSidebar(); }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function handleDragOver(e) { e.preventDefault(); document.body.classList.add('dragging'); }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function handleDragLeave(e) { if (e.relatedTarget === null) document.body.classList.remove('dragging'); }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function handleDrop(e) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>e.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.body.classList.remove('dragging');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const file = e.dataTransfer.files[0];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (file) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const reader = new FileReader();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>reader.onload = (event) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>stagedFile = { name: file.name, size: (file.size / 1024).toFixed(1) + ' KB', content: event.target.result };</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>document.getElementById('file-preview-area').style.display = 'flex';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>document.getElementById('staged-filename').innerText = file.name;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>reader.readAsText(file);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function clearStagedFile() { stagedFile = null; document.getElementById('file-preview-area').style.display = 'none'; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>async function handleSend() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const input = document.getElementById('user-input');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const val = input.value.trim();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!val &amp;&amp; !stagedFile) return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!activeId) createNewSession();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('empty-state').style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('chat-window').style.display = 'block';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>renderMsg(val || "File analysis", 'USER', true, stagedFile);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const context = stagedFile ? `[FILE: ${stagedFile.name}]\nContent: ${stagedFile.content}\n\nUser: ${val}` : val;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>input.value = '';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>clearStagedFile();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const aiBox = renderMsg('...', 'AI');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>await streamAI(context, aiBox);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function cleanText(t) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Removes commas and asterisks, keeps text and periods</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return t.replace(/[,*]/g, '');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>async function streamAI(prompt, element) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let fullText = "";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>method: "POST",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>headers: { "Authorization": `Bearer ${API_KEY}`, "Content-Type": "application/json" },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>body: JSON.stringify({</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>model: "google/gemini-2.0-flash-001",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>messages: [{role: "user", content: prompt}],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>stream: true</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>})</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const reader = response.body.getReader();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>while (true) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const {done, value} = await reader.read();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (done) break;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const chunk = new TextDecoder().decode(value);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const lines = chunk.split('\n');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>for (const line of lines) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (line.startsWith('data: ')) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const data = line.replace('data: ', '');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (data === '[DONE]') break;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const raw = JSON.parse(data).choices[0].delta.content || "";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>fullText += raw;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Update UI with cleaned text</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>element.innerText = cleanText(fullText);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const win = document.getElementById('chat-window');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (win.scrollHeight - win.scrollTop - win.clientHeight &lt; 200) win.scrollTop = win.scrollHeight;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>} catch(e){}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>sessions[activeId].messages.push({text: cleanText(fullText), sender: 'AI'});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>save();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function renderMsg(text, sender, push = true, fileObj = null) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const win = document.getElementById('chat-window');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const isAi = sender === 'AI';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const row = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>row.className = 'message-row';</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let fileHtml = fileObj ? `</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="file-attachment"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div&gt;<span class="s1">ðŸ“„</span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div&gt;&lt;div style="font-weight:600"&gt;${fileObj.name}&lt;/div&gt;&lt;div style="font-size:11px;color:#888"&gt;${fileObj.size}&lt;/div&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;` : "";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>row.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="message-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="msg-header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="avatar ${isAi ? 'ai-avatar' : ''}"&gt;${isAi ? 'AI' : 'U'}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="txt"&gt;${text}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>${fileHtml}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;`;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>win.appendChild(row);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>win.scrollTop = win.scrollHeight;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (push &amp;&amp; sender === 'USER') sessions[activeId].messages.push({text, sender, file: fileObj});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return row.querySelector('.txt');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function createNewSession() { activeId = 'S_' + Date.now(); sessions[activeId] = { name: "New Session", messages: [] }; save(); loadSess(activeId); }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function refreshSidebar() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const list = document.getElementById('history-list');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>list.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>Object.keys(sessions).reverse().forEach(id =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const item = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>item.className = `history-item ${id === activeId ? 'active' : ''}`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>item.innerHTML = `&lt;span style="flex:1; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;"&gt;${sessions[id].name}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="item-actions"&gt;&lt;span class="action-btn" onclick="renameSess('${id}', event)"&gt;<span class="s3">âœŽ</span>&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="action-btn" onclick="deleteSess('${id}', event)"&gt;<span class="s2">âœ•</span>&lt;/span&gt;&lt;/div&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>item.onclick = () =&gt; loadSess(id);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>list.appendChild(item);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function loadSess(id) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>activeId = id;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('empty-state').style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('chat-window').style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('chat-window').innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>sessions[id].messages.forEach(m =&gt; renderMsg(m.text, m.sender, false, m.file));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>refreshSidebar();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function renameSess(id, e) { e.stopPropagation(); const n = prompt("Rename:", sessions[id].name); if(n) { sessions[id].name = n; save(); } }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function deleteSess(id, e) { e.stopPropagation(); if(confirm("Delete?")) { delete sessions[id]; if (activeId === id) activeId = null; save(); location.reload(); } }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>refreshSidebar();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
